(this.webpackJsonpdndtracker=this.webpackJsonpdndtracker||[]).push([[0],{229:function(e,t,n){},333:function(e,t,n){},334:function(e,t,n){},341:function(e,t,n){},342:function(e,t,n){"use strict";n.r(t);var i,a=n(1),r=n.n(a),c=n(70),s=n.n(c),o=(n(229),n(388)),l=n(105),d=n(54),j=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,394)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),i(e),a(e),r(e),c(e)}))},u=n(3),b=n(367),h=n(384),O=n(381),x=n(362),p=n(377),m=n(31),f=n(81),v=Object(f.b)({name:"campaign",initialState:{currentTurnId:"",campaignTitle:"D&D Tracker",notes:{}},reducers:{setTurn:function(e,t){e.currentTurnId=t.payload},setCampaignTitle:function(e,t){e.campaignTitle=t.payload},setCampaignNotes:function(e,t){e.notes=t.payload}}}),g=v.actions,y=g.setTurn,w=g.setCampaignTitle,C=(g.setCampaignNotes,v.reducer),P=function(){return Object(l.b)()},S=l.c,k=n(13),H=n(10),I=n(390),M=n(12);!function(e){e[e.d100=100]="d100",e[e.d20=20]="d20",e[e.d12=12]="d12",e[e.d10=10]="d10",e[e.d8=8]="d8",e[e.d6=6]="d6",e[e.d4=4]="d4",e[e.d2=2]="d2"}(i||(i={}));var T=function(e){return Math.ceil(Math.random()*e)};function A(){return new URLSearchParams(Object(m.g)().search)}var N=Object(f.b)({name:"npc",initialState:{npcs:[]},reducers:{addNPC:function(e,t){var n=Object(I.a)();e.npcs.push(Object(H.a)(Object(H.a)({},t.payload),{},{id:n}))},removeNPC:function(e,t){var n=e.npcs.findIndex((function(e){return e.id===t.payload}));n>=0?e.npcs.splice(n,1):console.warn("Invalid NPC ".concat(t.payload))},refreshNPCs:function(e,t){var n;t.payload&&(n=e.npcs).splice.apply(n,[0,e.npcs.length].concat(Object(k.a)(t.payload)))},modifyNPC:function(e,t){var n=e.npcs.findIndex((function(e){return e.id===t.payload.id}));n>=0&&(e.npcs[n]=Object(H.a)(Object(H.a)({},e.npcs[n]),t.payload))},rollAllNPCInitiative:function(e){e.npcs.forEach((function(e){e.initiative=T(i.d20)}))}}}),F=M.d({name:M.e(),currentHP:M.c().integer().required(),maxHP:M.c().integer().required(),tempHP:M.c().integer().default(0).required(),armourClass:M.c().integer().required(),initiative:M.c().integer().min(1).max(20).required(),initiativeMod:M.c().integer().required(),notes:M.e(),externalNotes:M.a().of(M.d({type:M.e(),url:M.e().url(),label:M.e()})),conditions:M.a().of(M.e()).required(),displayOnTurnOrder:M.b().required(),isHostile:M.b().required(),isFriendly:M.b().required(),isBoss:M.b().required(),showHealth:M.b().required(),showInitiative:M.b().required(),showAC:M.b().required(),showName:M.b().required()}),E=N.actions,R=E.addNPC,z=E.removeNPC,q=E.refreshNPCs,D=(E.rollAllNPCInitiative,E.modifyNPC),W=N.reducer,L=Object(f.b)({name:"player",initialState:{players:[]},reducers:{addPlayer:function(e,t){var n=Object(I.a)();e.players.push(Object(H.a)(Object(H.a)({},t.payload),{},{id:n}))},removePlayer:function(e,t){var n=e.players.findIndex((function(e){return e.id===t.payload}));n>=0?e.players.splice(n,1):console.warn("Invalid player ".concat(t.payload))},refreshPlayers:function(e,t){var n;t.payload&&(n=e.players).splice.apply(n,[0,e.players.length].concat(Object(k.a)(t.payload)))},modifyPlayer:function(e,t){var n=e.players.findIndex((function(e){return e.id===t.payload.id}));if(n>=0){var i=e.players,a=t.payload;(t.payload.conditions||i[n].conditions).map((function(e){return e.toLowerCase()})).includes("dying")||(a.passedDeathSaves=0,a.failedDeathSaves=0),i[n]=Object(H.a)(Object(H.a)({},e.players[n]),t.payload)}},rollAllPlayerInitiative:function(e){e.players.forEach((function(e){e.initiative=T(i.d20)}))}}}),_=M.d({name:M.e(),currentHP:M.c().integer().required(),maxHP:M.c().integer().required(),tempHP:M.c().integer().default(0).required(),armourClass:M.c().integer().required(),initiative:M.c().integer().min(1).max(20).required(),initiativeMod:M.c().integer().required(),notes:M.e(),externalNotes:M.a().of(M.d({type:M.e(),url:M.e().url(),label:M.e()})),conditions:M.a().of(M.e()).required(),displayOnTurnOrder:M.b().required()}),V=L.actions,J=V.addPlayer,U=V.removePlayer,B=V.refreshPlayers,G=V.rollAllPlayerInitiative,K=V.modifyPlayer,Q=L.reducer,X="persistantState",Y="0.0.3",Z=function(){try{var e=localStorage.getItem("persistantState_".concat(Y));if(null===e)return;return JSON.parse(e)}catch(t){return void console.warn(t)}},$=Object(f.a)({reducer:{players:Q,campaign:C,npcs:W},preloadedState:Z()});$.subscribe((function(){document.hasFocus()&&function(e){try{var t=JSON.stringify(e);localStorage.setItem("persistantState_".concat(Y),t)}catch(n){console.warn(n)}}($.getState())}));var ee=n(360),te=n(363),ne=n(96),ie=n(364),ae=n(74),re=n(91),ce=n(90),se=n(2),oe=function(){var e=S((function(e){return e.campaign.campaignTitle})),t=P(),n=function(e){return t(w(e))},i=Object(a.useState)(e),c=Object(u.a)(i,2),s=c[0],o=c[1],l=Object(a.useState)(!1),d=Object(u.a)(l,2),j=d[0],b=d[1],h=r.a.useRef(null);return Object(se.jsxs)(ee.a,{mb:4,width:"100%",justifyContent:"center",alignItems:"center",children:[!j&&Object(se.jsxs)(ee.a,{justifyContent:"center",alignItems:"center",children:[Object(se.jsx)(x.a,{children:e}),Object(se.jsx)(te.a,{ml:2,"aria-label":"Edit Title",icon:Object(se.jsx)(ne.a,{as:ae.f}),onClick:function(){b(!0),setTimeout((function(){var e;null===(e=h.current)||void 0===e||e.focus()}),100)}})]}),j&&Object(se.jsxs)(ee.a,{justifyContent:"center",alignItems:"center",children:[Object(se.jsx)(ie.a,{ref:h,onChange:function(e){return o(e.target.value)},onKeyPress:function(e){"Enter"===e.code&&(b(!1),n(s))}}),Object(se.jsx)(te.a,{ml:2,"aria-label":"Save",icon:Object(se.jsx)(ne.a,{as:ce.a}),onClick:function(){b(!1),n(s)}}),Object(se.jsx)(te.a,{ml:2,"aria-label":"Reset",icon:Object(se.jsx)(ne.a,{as:re.a}),onClick:function(){return b(!1)}})]})]})},le=n(366),de=n(368),je=n(34),ue=n(391),be=n(28),he=n(365),Oe=function(e){var t=e.to,n=e.label,i=e.activeOnlyWhenExact,a=e.icon,r=Object(m.f)(),c=Object(m.i)({path:t,exact:i});return Object(se.jsxs)(ee.a,{cursor:"pointer",width:"100%",textAlign:"left",borderRadius:10,backgroundColor:c?"gray":void 0,p:2,fontWeight:"bold",color:c?"white":"black",onClick:function(){r.push(t)},alignItems:"center",children:[Object(se.jsx)(ee.a,{width:"10%",children:a&&Object(se.jsx)(ne.a,{as:a})}),Object(se.jsx)(he.a,{children:n})]})};var xe,pe=function(e){var t=e.routes,n=function(){var e=r.a.useState({width:0,height:0}),t=Object(u.a)(e,2),n=t[0],i=t[1];return Object(a.useEffect)((function(){function e(){i({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}().width>1400,i=Object(le.a)({defaultIsOpen:n}),c=i.isOpen,s=i.onOpen,o=i.onClose;return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)("div",{className:"drawer-button",children:Object(se.jsx)(b.a,{pt:3,pb:3,pl:4,pr:4,cursor:"pointer",onClick:s,children:Object(se.jsx)(ne.a,{as:be.d})})}),Object(se.jsxs)(de.a,{isOpen:n||c,placement:"left",onClose:function(){n||o()},blockScrollOnMount:!n,variant:n?"alwaysOpen":void 0,trapFocus:!n,children:[!n&&Object(se.jsx)(je.h,{}),Object(se.jsxs)(de.b,{children:[!n&&Object(se.jsx)(je.c,{}),Object(se.jsx)(je.g,{children:"Menu"}),Object(se.jsx)(je.b,{children:Object(se.jsx)(ue.c,{spacing:0,children:t.filter((function(e){return!e.disabled})).map((function(e){var t=e.pageTitle,n=e.path,i=e.exact,a=e.icon;return Object(se.jsx)(Oe,{to:n,label:t,activeOnlyWhenExact:i,icon:a},t)}))})}),Object(se.jsx)(je.f,{})]})]})]})},me=(n(333),n(58)),fe=n(45),ve=n(83),ge=n(375),ye=n(373),we=n(82),Ce=n(369),Pe=n(374),Se=n(216),ke=n(18),He=n(66),Ie=n(370),Me=function(e){var t=e.children,n=e.name,i=e.label,a=e.helperText,r=e.hideError,c=Object(He.a)(e,["children","name","label","helperText","hideError"]),s=Object(ke.d)(n),o=Object(u.a)(s,2)[1],l=o.error,d=o.touched;return Object(se.jsxs)(we.a,Object(H.a)(Object(H.a)({isInvalid:!!l&&d},c),{},{children:[i&&Object(se.jsx)(Ce.a,{htmlFor:n,children:i}),t,!r&&l&&Object(se.jsx)(Ie.a,{children:l}),a&&Object(se.jsx)(we.b,{children:a})]}))},Te=function(e){var t=e.name,n=e.label,i=e.inputProps,a=Object(He.a)(e,["name","label","inputProps"]),r=Object(ke.d)(t),c=Object(u.a)(r,1)[0];return Object(se.jsx)(Me,Object(H.a)(Object(H.a)({name:t,label:n},a),{},{children:Object(se.jsx)(ie.a,Object(H.a)(Object(H.a)({},c),{},{id:t},i))}))},Ae=n(387),Ne=function(e){var t,n=e.name,i=e.label,a=e.showStepper,r=void 0===a||a,c=e.children,s=e.numberInputProps,o=e.fieldId,l=Object(He.a)(e,["name","label","showStepper","children","numberInputProps","fieldId"]),d=Object(ke.d)(n),j=Object(u.a)(d,2),b=j[0],h=j[1],O=h.error,x=h.touched,p=Object(ke.e)().setFieldValue;return Object(se.jsx)(Me,Object(H.a)(Object(H.a)({name:n,label:i},l),{},{children:Object(se.jsxs)(Ae.c,Object(H.a)(Object(H.a)(Object(H.a)({},b),{},{id:n,onChange:(t=n,function(e){return p(t,Number(e))}),isInvalid:!!O&&x},s),{},{children:[Object(se.jsx)(Ae.d,{name:n,id:o}),r&&Object(se.jsxs)(Ae.e,{children:[Object(se.jsx)(Ae.b,{}),Object(se.jsx)(Ae.a,{})]}),c]}))}))},Fe=n(205),Ee=n(372),Re=n(55),ze=function(e){var t=e.name,n=e.label,i=e.switchProps,a=Object(He.a)(e,["name","label","switchProps"]),r=Object(ke.d)(t),c=Object(u.a)(r,2),s=c[0],o=c[1],l=o.error,d=o.touched;return Object(se.jsx)(b.a,{css:Object(Re.b)(xe||(xe=Object(Fe.a)(["\n        .chakra-form__label {\n          margin-bottom: 0;\n        }\n        .chakra-switch {\n          display: flex;\n          align-items: center;\n          margin-right: 0.75rem;\n        }\n        .chakra-form__error-message {\n          margin-top: 0;\n        }\n      "]))),children:Object(se.jsx)(Me,Object(H.a)(Object(H.a)({name:t,label:n,as:ee.a,alignItems:"center"},a),{},{children:Object(se.jsx)(Ee.a,Object(H.a)(Object(H.a)({},s),{},{id:t,isInvalid:!!l&&d,isChecked:s.value},i))}))})};function qe(){var e=Object(ke.e)(),t=e.setFieldValue,n=e.values;return Object(se.jsxs)(ue.c,{mt:4,mb:4,children:[Object(se.jsx)(ye.a,{mt:4,mb:4,fontSize:"sm",templateColumns:"repeat(3, 1fr)",spacing:4,width:"100%",children:[["Show on Turn Order","displayOnTurnOrder"],["Show name","showName"],["Show health","showHealth"],["Show AC","showAC"],["Show initiative","showInitiative"],["Roll initiative on creation","rollInitiativeOnCreate"]].map((function(e){var t=Object(u.a)(e,2),n=t[0],i=t[1];return Object(se.jsxs)(we.a,{display:"flex",alignItems:"center",children:[Object(se.jsx)(Ce.a,{mb:"0",fontSize:"xs",children:n}),Object(se.jsx)(Pe.a,{}),Object(se.jsx)(ze,{name:i})]},i)}))}),!n.rollInitiativeOnCreate&&Object(se.jsxs)(ue.a,{width:"100%",children:[Object(se.jsx)(Se.a,{width:"100%",onClick:function(){return t("initiative",T(i.d20))},variant:"outline",rightIcon:Object(se.jsx)(ne.a,{as:be.c}),children:"Roll Initiative"}),Object(se.jsxs)(ue.a,{children:[Object(se.jsx)(he.a,{children:"Initiative"}),Object(se.jsx)(Ne,{hideError:!0,name:"initiative",width:"8em"})]})]})]})}function De(e){var t=e.showFriendly,n=e.showHostile,a=P(),r=M.d({name:M.e().required().label("Name"),maxHP:M.c().integer().moreThan(0).required().label("Maximum HP"),initiativeMod:M.c().integer().required().label("Initiative Modifier"),armourClass:M.c().integer().moreThan(0).default(10).label("Armour Class"),initiative:M.c().integer().min(1).max(20),rollInitiativeOnCreate:M.b(),displayOnTurnOrder:M.b(),showHealth:M.b(),showInitiative:M.b(),showAC:M.b(),showName:M.b()}),c=[["NPC Name","name",Te],["Maximum HP","maxHP",Ne],["Initiative Modifier","initiativeMod",Ne],["Armour Class","armourClass",Ne]];return Object(se.jsx)(ke.c,{initialValues:{name:"",maxHP:0,initiativeMod:0,armourClass:0,initiative:1,rollInitiativeOnCreate:!0,displayOnTurnOrder:!0,showHealth:!1,showInitiative:!1,showAC:!1,showName:!1},validationSchema:r,onSubmit:function(e,r){var c=e.rollInitiativeOnCreate?T(i.d20):e.initiative;r.setFieldValue("initiative",c),a(R({name:e.name,maxHP:e.maxHP,currentHP:e.maxHP,tempHP:0,initiative:c,initiativeMod:e.initiativeMod,armourClass:e.armourClass,conditions:[],displayOnTurnOrder:e.displayOnTurnOrder,notes:"",externalNotes:[],isFriendly:t||!1,isHostile:n||!1,isBoss:!1,showHealth:e.showHealth,showInitiative:e.showInitiative,showAC:e.showAC,showName:e.showName}))},children:Object(se.jsxs)(ke.b,{children:[Object(se.jsx)(ue.a,{mt:4,mb:4,children:c.map((function(e){var t=Object(u.a)(e,3),n=t[0],i=t[1],a=t[2];return Object(se.jsx)(a,{hideError:!0,name:i,label:n},i)}))}),Object(se.jsx)(qe,{}),Object(se.jsxs)(Se.a,{mb:4,width:"100%",type:"submit",variant:"solid",colorScheme:"green",rightIcon:Object(se.jsx)(ne.a,{as:ge.a}),children:["Add"," ",n?"Enemy":"NPC"]})]})})}var We=n(389),Le=n(206),_e=n(386),Ve=n(376),Je=function(e){var t=e.name,n=e.label,i=e.textareaProps,a=Object(He.a)(e,["name","label","textareaProps"]),r=Object(ke.d)(t),c=Object(u.a)(r,1)[0];return Object(se.jsx)(Me,Object(H.a)(Object(H.a)({name:t,label:n},a),{},{children:Object(se.jsx)(Ve.a,Object(H.a)(Object(H.a)({},c),{},{id:t},i))}))},Ue=n(378),Be=function(e){var t=e.character,n=Object(ke.e)();return Object(se.jsx)(ke.a,{name:"conditions",render:function(e){var i=function(){var n=document.querySelector("#tag-input-".concat(t.id));if(null===n||void 0===n?void 0:n.value){var i=n.value.toString();n.value="",e.push(i)}};return Object(se.jsxs)(b.a,{p:2,border:"1px solid #00000066",borderRadius:8,mb:2,children:[Object(se.jsx)(ee.a,{justifyContent:"center",children:Object(se.jsx)(he.a,{fontWeight:"bold",children:"Conditions"})}),Object(se.jsx)(p.a,{mt:1,mb:1,opacity:"0.3"}),n.values.conditions.map((function(t,n){return Object(se.jsxs)(Ue.a,{variant:"solid",borderRadius:"full",size:"lg",m:1,children:[Object(se.jsx)(Ue.c,{children:t}),Object(se.jsx)(Ue.b,{onClick:function(){return e.remove(n)}})]},t)})),Object(se.jsxs)(Ue.a,{variant:"outline",borderRadius:"full",size:"lg",m:1,children:[Object(se.jsx)(ie.a,{size:"xs",id:"tag-input-".concat(t.id),onKeyPress:function(e){"Enter"===e.code&&i()}}),Object(se.jsx)(Ue.d,{as:ge.a,cursor:"pointer",onClick:function(){i()}})]})]})}})},Ge=function(e){var t=e.character,n=Object(ke.e)();return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(b.a,{children:Object(se.jsxs)(ue.a,{children:[Object(se.jsx)(he.a,{fontWeight:"bold",children:"THP "}),Object(se.jsx)(Ne,{hideError:!0,name:"tempHP",width:"6em",onKeyPress:function(e){return"Enter"===e.code&&n.submitForm()}})]})}),Object(se.jsx)(b.a,{children:Object(se.jsxs)(ue.a,{children:[Object(se.jsx)(he.a,{fontWeight:"bold",children:"HP "}),Object(se.jsx)(Ne,{hideError:!0,name:"currentHP",width:"6em",fieldId:"currentHP-".concat(t.id),onKeyPress:function(e){return"Enter"===e.code&&n.submitForm()}}),Object(se.jsxs)(he.a,{children:["/"," ",t.maxHP]})]})})]})},Ke=n(379),Qe=function(e){var t=e.character,n=Object(ke.e)(),i=null===n||void 0===n?void 0:n.errors;return Object(se.jsxs)(We.d,{children:[Object(se.jsxs)(We.b,{children:[Object(se.jsx)(b.a,{flex:"1",textAlign:"left",children:Object(se.jsx)("strong",{children:"External Notes"})}),Object(se.jsx)(We.c,{})]}),Object(se.jsx)(We.e,{children:Object(se.jsx)(ke.a,{name:"externalNotes",render:function(e){var a="link-label-".concat(t.id),r="link-url-".concat(t.id);return Object(se.jsxs)(ue.c,{children:[n.values.externalNotes.map((function(t,n){return Object(se.jsxs)(ee.a,{alignItems:"center",width:"100%",border:"0.2em solid #0000FF22",borderRadius:6,cursor:"pointer",_hover:{border:"0.2em solid #0000FF"},transition:"0.2s",children:[Object(se.jsx)(b.a,{p:1.5,onClick:function(){return window.open(t.url,"_blank")},children:Object(se.jsx)(ne.a,{as:me.d,w:6,h:6,color:"blue"})}),Object(se.jsxs)(he.a,{color:"blue",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",onClick:function(){return window.open(t.url,"_blank")},width:"100%",children:[t.label," ","(",t.url,")"]}),Object(se.jsx)(Pe.a,{}),Object(se.jsx)(te.a,{ml:1,"aria-label":"Save",icon:Object(se.jsx)(ne.a,{as:Ke.a}),color:"red",variant:"ghost",onClick:function(){return e.remove(n)}})]},t.label+t.url)})),Object(se.jsxs)(ue.a,{width:"100%",children:[Object(se.jsx)(ie.a,{placeholder:"Link Label",id:a}),Object(se.jsx)(ie.a,{placeholder:"URL",id:r}),Object(se.jsx)(te.a,{ml:2,"aria-label":"Save",icon:Object(se.jsx)(ne.a,{as:ge.a}),colorScheme:"blue",variant:"outline",onClick:function(){return function(){var t=document.querySelector("#".concat(a)),n=document.querySelector("#".concat(r));if((null===t||void 0===t?void 0:t.value)&&(null===n||void 0===n?void 0:n.value)){var i=t.value.toString(),c=n.value.toString();t.value="",n.value="";var s={type:"link",label:i,url:c};e.push(s)}}()}})]}),Object(se.jsx)(he.a,{width:"100%",color:"red",hidden:!(i.externalNotes&&i.externalNotes.length>0),children:"There are errors with the links inserted. Make sure the URLs are of a valid format."})]})}})})]})},Xe=function(e){["#link-label-".concat(e.id),"#link-url-".concat(e.id),"#tag-input-".concat(e.id)].forEach((function(e){var t=document.querySelector(e);t&&(t.value="")}))},Ye=function(e){var t=e.npc,n=P(),a=Object(m.h)(),r=function(e){return n(D(e))},c=Gt.neutral;t.isHostile?c=Gt.enemy:t.isFriendly&&(c=Gt.friendly);var s=function(){var e=Object(ke.e)().setFieldValue;return Object(se.jsxs)(We.d,{children:[Object(se.jsxs)(We.b,{children:[Object(se.jsx)(b.a,{flex:"1",textAlign:"left",children:Object(se.jsx)("strong",{children:"Edit Stats"})}),Object(se.jsx)(We.c,{})]}),Object(se.jsx)(We.e,{children:Object(se.jsxs)(Le.a,{fontSize:"sm",templateColumns:"repeat(4, 1fr)",templateRows:"repeat(2, 1fr)",gap:4,children:[Object(se.jsx)(Le.b,{colSpan:4,children:Object(se.jsx)(Se.a,{width:"100%",onClick:function(){return e("initiative",T(i.d20))},variant:"outline",rightIcon:Object(se.jsx)(ne.a,{as:be.c}),children:"Roll Initiative"})}),[["AC: ","armourClass"],["Initiative: ","initiative"],["Init. Mod: ","initiativeMod"],["Max HP: ","maxHP"]].map((function(e){var t=Object(u.a)(e,2),n=t[0],i=t[1];return Object(se.jsx)(Le.b,{children:Object(se.jsxs)(ue.a,{children:[Object(se.jsx)(he.a,{children:n}),Object(se.jsx)(Ne,{hideError:!0,name:i,width:"8em"})]})},i)}))]})})]})},o=function(e){var t=e.npc,i=Object(ke.e)();return Object(se.jsxs)(ue.a,{mt:4,children:[Object(se.jsx)(_e.a,{label:"Save",placement:"top",children:Object(se.jsx)(Se.a,{width:"100%",hidden:!i.dirty,variant:"solid",colorScheme:"green",onClick:function(){return i.submitForm()},children:Object(se.jsx)(ne.a,{as:ce.a})})}),Object(se.jsx)(_e.a,{label:"Reset",placement:"top",children:Object(se.jsx)(Se.a,{width:"100%",type:"reset",hidden:!i.dirty,variant:"solid",children:Object(se.jsx)(ne.a,{as:re.a})})}),Object(se.jsx)(_e.a,{label:"Delete",placement:"top",children:Object(se.jsx)(Se.a,{width:"100%",onClick:function(){return e=t.id,n(z(e));var e},variant:"solid",colorScheme:"red",children:Object(se.jsx)(ne.a,{as:me.a})})})]})},l=function(){r(Object(H.a)(Object(H.a)({},t),{},{displayOnTurnOrder:!t.displayOnTurnOrder}))},d=function(){return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(_e.a,{label:"".concat(t.displayOnTurnOrder?"Hide":"Show"," in turn order"),placement:"top",children:Object(se.jsx)(Se.a,{variant:"outline",color:t.displayOnTurnOrder?"black":"gray.400",onClick:l,children:Object(se.jsx)(ne.a,{as:t.displayOnTurnOrder?fe.a:fe.b})})}),Object(se.jsx)(b.a,{textAlign:"center",width:"100%",backgroundColor:c,color:"white",borderRadius:8,p:2,children:Object(se.jsx)(he.a,{fontWeight:"bold",children:t.name})}),Object(se.jsx)(o,{npc:t})]})};return Object(se.jsx)(ke.c,{initialValues:Object(H.a)(Object(H.a)({},t),{},{externalNotes:t.externalNotes||[]}),onSubmit:function(e,n){r(e),Xe(t),n.resetForm()},onReset:function(){Xe(t)},enableReinitialize:!0,validationSchema:F,children:Object(se.jsx)(b.a,{className:"",width:"100%",id:"character-".concat(t.id),border:"0.3em solid ".concat(c).concat(a.id===t.id?"FF":22),borderRadius:10,p:4,children:Object(se.jsxs)(ke.b,{children:[Object(se.jsx)(ue.a,{p:1,mb:2,children:Object(se.jsx)(d,{})}),Object(se.jsxs)(ye.a,{templateColumns:"repeat(3, 1fr)",mt:4,mb:4,children:[Object(se.jsx)(Le.b,{children:Object(se.jsxs)(ue.c,{alignItems:"flex-start",children:[Object(se.jsx)(Ge,{character:t}),Object(se.jsxs)(he.a,{children:["AC"," ",t.armourClass,", Init."," ",t.initiative+t.initiativeMod," ","(",t.initiative,Object(se.jsx)(ne.a,{as:be.c})," ",t.initiativeMod>=0?"+":"-"," ",Math.abs(t.initiativeMod),")"]})]})}),Object(se.jsx)(Le.b,{colSpan:2,children:Object(se.jsx)(Je,{name:"notes",textareaProps:{resize:"vertical",height:"20em",fontSize:"xs"}})})]}),Object(se.jsx)(Be,{character:t}),Object(se.jsxs)(We.a,{allowToggle:!0,allowMultiple:!0,children:[Object(se.jsx)(Qe,{character:t}),Object(se.jsx)(s,{}),Object(se.jsxs)(We.d,{children:[Object(se.jsxs)(We.b,{children:[Object(se.jsx)(b.a,{flex:"1",textAlign:"left",children:Object(se.jsx)("strong",{children:"Options"})}),Object(se.jsx)(We.c,{})]}),Object(se.jsx)(We.e,{children:Object(se.jsx)(Le.a,{fontSize:"sm",templateColumns:"repeat(4, 1fr)",templateRows:"repeat(2, 1fr)",gap:6,children:[["Reveal Name","showName"],["Reveal Health","showHealth"],["Reveal Armour Class","showAC"],["Reveal Initiative","showInitiative"],["Hostile to Party","isHostile"],["Friendly to Party","isFriendly"]].map((function(e){var t=Object(u.a)(e,2),n=t[0],i=t[1];return Object(se.jsxs)(we.a,{display:"flex",alignItems:"center",children:[Object(se.jsx)(Ce.a,{mb:"0",fontSize:"xs",children:n}),Object(se.jsx)(Pe.a,{}),Object(se.jsx)(ze,{name:i})]},i)}))})})]})]})]})})})},Ze=function(e){var t=e.npcs;return Object(se.jsx)(ue.c,{children:t.map((function(e){return Object(se.jsx)(Ye,{npc:e},e.id)}))})};function $e(e){var t=e.showHostile,n=e.showFriendly,i=e.showNeutral,a=Object(m.h)(),r=S((function(e){return e.npcs.npcs.filter((function(e){return!(!t||!e.isHostile)||(!(!n||!e.isFriendly)||!(!i||e.isFriendly||e.isHostile))})).filter((function(e){return!a.id||e.id===a.id}))}));return Object(se.jsxs)(se.Fragment,{children:[!a.id&&Object(se.jsx)(De,{showHostile:t,showFriendly:n}),Object(se.jsx)(Ze,{npcs:r})]})}var et=function(e){var t=e.player,n=P(),a=Object(m.h)(),r=function(e){return n(K(e))},c=function(){var e=Object(ke.e)().setFieldValue;return Object(se.jsxs)(We.d,{children:[Object(se.jsxs)(We.b,{children:[Object(se.jsx)(b.a,{flex:"1",textAlign:"left",children:Object(se.jsx)("strong",{children:"Edit Stats"})}),Object(se.jsx)(We.c,{})]}),Object(se.jsx)(We.e,{children:Object(se.jsxs)(Le.a,{fontSize:"sm",templateColumns:"repeat(4, 1fr)",templateRows:"repeat(2, 1fr)",gap:4,children:[Object(se.jsx)(Le.b,{colSpan:4,children:Object(se.jsx)(Se.a,{width:"100%",onClick:function(){return e("initiative",T(i.d20))},variant:"outline",rightIcon:Object(se.jsx)(ne.a,{as:be.c}),children:"Roll Initiative"})}),[["AC: ","armourClass"],["Initiative: ","initiative"],["Init. Mod: ","initiativeMod"],["Max HP: ","maxHP"]].map((function(e){var t=Object(u.a)(e,2),n=t[0],i=t[1];return Object(se.jsx)(Le.b,{children:Object(se.jsxs)(ue.a,{children:[Object(se.jsx)(he.a,{children:n}),Object(se.jsx)(Ne,{hideError:!0,name:i,width:"8em"})]})},i)}))]})})]})},s=function(e){var t=e.player,i=Object(ke.e)();return Object(se.jsxs)(ue.a,{mt:4,children:[Object(se.jsx)(_e.a,{label:"Save",placement:"top",children:Object(se.jsx)(Se.a,{width:"100%",hidden:!i.dirty,variant:"solid",colorScheme:"green",onClick:function(){return i.submitForm()},children:Object(se.jsx)(ne.a,{as:ce.a})})}),Object(se.jsx)(_e.a,{label:"Reset",placement:"top",children:Object(se.jsx)(Se.a,{width:"100%",type:"reset",hidden:!i.dirty,variant:"solid",children:Object(se.jsx)(ne.a,{as:re.a})})}),Object(se.jsx)(_e.a,{label:"Delete",placement:"top",children:Object(se.jsx)(Se.a,{width:"100%",onClick:function(){return e=t.id,n(U(e));var e},variant:"solid",colorScheme:"red",children:Object(se.jsx)(ne.a,{as:me.a})})})]})},o=function(){r(Object(H.a)(Object(H.a)({},t),{},{displayOnTurnOrder:!t.displayOnTurnOrder}))},l=function(){return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(_e.a,{label:"".concat(t.displayOnTurnOrder?"Hide":"Show"," in turn order"),placement:"top",children:Object(se.jsx)(Se.a,{variant:"outline",color:t.displayOnTurnOrder?"black":"gray.400",onClick:o,children:Object(se.jsx)(ne.a,{as:t.displayOnTurnOrder?fe.a:fe.b})})}),Object(se.jsx)(b.a,{textAlign:"center",width:"100%",backgroundColor:"darkgreen",color:"white",borderRadius:8,p:2,children:Object(se.jsx)(he.a,{fontWeight:"bold",children:t.name})}),Object(se.jsx)(s,{player:t})]})};return Object(se.jsx)(ke.c,{initialValues:Object(H.a)(Object(H.a)({},t),{},{externalNotes:t.externalNotes||[]}),onSubmit:function(e,n){r(e),Xe(t),n.resetForm()},onReset:function(){Xe(t)},enableReinitialize:!0,validationSchema:_,children:Object(se.jsx)(b.a,{className:"",width:"100%",id:"character-".concat(t.id),border:"0.3em solid #00AA00".concat(a.id===t.id?"FF":22),borderRadius:10,p:4,children:Object(se.jsxs)(ke.b,{children:[Object(se.jsx)(ue.a,{p:1,mb:2,children:Object(se.jsx)(l,{})}),Object(se.jsxs)(ye.a,{templateColumns:"repeat(3, 1fr)",mt:4,mb:4,children:[Object(se.jsx)(Le.b,{children:Object(se.jsxs)(ue.c,{alignItems:"flex-start",children:[Object(se.jsx)(Ge,{character:t}),Object(se.jsxs)(he.a,{children:["AC"," ",t.armourClass,", Init."," ",t.initiative+t.initiativeMod," ","(",t.initiative,Object(se.jsx)(ne.a,{as:be.c})," ",t.initiativeMod>=0?"+":"-"," ",Math.abs(t.initiativeMod),")"]})]})}),Object(se.jsx)(Le.b,{colSpan:2,children:Object(se.jsx)(Je,{name:"notes",textareaProps:{resize:"vertical",height:"20em",fontSize:"xs"}})})]}),Object(se.jsx)(Be,{character:t}),Object(se.jsxs)(We.a,{allowToggle:!0,allowMultiple:!0,children:[Object(se.jsx)(Qe,{character:t}),Object(se.jsx)(c,{})]})]})})})},tt=function(e){var t=e.players;return Object(se.jsx)(ue.c,{children:t.map((function(e){return Object(se.jsx)(et,{player:e},e.id)}))})};function nt(){var e=Object(m.h)(),t=S((function(t){return t.players.players.filter((function(t){return!e.id||t.id===e.id}))})),n=P(),a=M.d({name:M.e().required().label("Name"),maxHP:M.c().integer().moreThan(0).required().label("Maximum HP"),initiativeMod:M.c().integer().required().label("Initiative Modifier"),armourClass:M.c().integer().moreThan(0).default(10).label("Armour Class")}),r=function(){var e=[["Player Name","name",Te],["Maximum HP","maxHP",Ne],["Initiative Modifier","initiativeMod",Ne],["Armour Class","armourClass",Ne]];return Object(se.jsx)(ke.c,{initialValues:{name:"",maxHP:0,initiativeMod:0,armourClass:0},validationSchema:a,onSubmit:function(e){n(J({name:e.name,maxHP:e.maxHP,currentHP:e.maxHP,tempHP:0,initiative:T(i.d20),initiativeMod:e.initiativeMod,armourClass:e.armourClass,conditions:[],displayOnTurnOrder:!0,notes:"",externalNotes:[],passedDeathSaves:0,failedDeathSaves:0}))},children:Object(se.jsxs)(ke.b,{children:[Object(se.jsx)(ue.a,{children:e.map((function(e){var t=Object(u.a)(e,3),n=t[0],i=t[1],a=t[2];return Object(se.jsx)(a,{hideError:!0,mt:4,mb:4,name:i,label:n},i)}))}),Object(se.jsx)(Se.a,{mb:4,width:"100%",type:"submit",variant:"solid",colorScheme:"green",rightIcon:Object(se.jsx)(ne.a,{as:ge.a}),children:"Add Player"})]})})};return Object(se.jsxs)(se.Fragment,{children:[!e.id&&Object(se.jsx)(r,{}),Object(se.jsx)(tt,{players:t})]})}var it=n(7),at=n(207),rt=n(208),ct=n(393),st=n(380),ot=n(346),lt=n(382);function dt(e){var t=e.npc,n=e.isActive,i=e.tinyMode,a=e.onClick,r=t.tempHP?" (".concat(t.tempHP,")"):"",c=Gt.neutral;return t.isHostile?c=Gt.enemy:t.isFriendly&&(c=Gt.friendly),Object(se.jsxs)(b.a,{className:"turn-block turn-block-npc",p:i?"0.1em":"0.5em",border:"".concat(n&&!i?"0.4em":"0.2em"," solid ").concat(c).concat(n?"FF":22),borderRadius:"0.4em",opacity:n?"100%":"80%",cursor:"pointer",onClick:a,children:[Object(se.jsxs)(Le.a,{templateColumns:"repeat(4, 1fr)",fontSize:i?"sm":"md",children:[Object(se.jsx)(he.a,{fontWeight:"bold",children:t.showName?t.name:"???"}),t.showAC?Object(se.jsxs)(he.a,{children:[Object(se.jsx)(ne.a,{as:be.b})," ",t.armourClass]}):Object(se.jsx)(he.a,{}),t.showHealth?Object(se.jsxs)(he.a,{children:[Object(se.jsx)(ne.a,{as:fe.c})," ",t.currentHP," ",r," ","/"," ",t.maxHP]}):Object(se.jsxs)(he.a,{color:"red.800",children:[Object(se.jsx)(ne.a,{as:ve.d})," ",Math.max(t.maxHP-t.currentHP,0)]}),t.showInitiative?Object(se.jsxs)(he.a,{children:[Object(se.jsx)(ne.a,{as:be.e})," ",t.initiative+t.initiativeMod," ","(",t.initiative,Object(se.jsx)(ne.a,{as:be.c})," ",t.initiativeMod>=0?"+":"-"," ",Math.abs(t.initiativeMod),")"]}):Object(se.jsx)(he.a,{})]}),t.conditions.length>0&&Object(se.jsx)(ue.a,{children:t.conditions.map((function(e){return Object(se.jsx)(st.a,{variant:"solid",children:e},e)}))})]})}n(334);var jt=n(158),ut=n(159),bt=function(e){var t=e.player,n=e.size,i=e.disableAction,a=P(),r=function(e,n){if(!i){var r="failedDeathSaves";"pass"===n&&(r="passedDeathSaves"),a(K(Object(it.a)({id:t.id},r,e)))}},c=function(e){return t.failedDeathSaves>=e?Object(se.jsx)(ne.a,{as:jt.a,color:"darkred"}):Object(se.jsx)(ne.a,{as:jt.b})},s=function(e){return t.passedDeathSaves>=e?Object(se.jsx)(ne.a,{as:ut.b,color:"green"}):Object(se.jsx)(ne.a,{as:ut.a})};return Object(se.jsxs)(O.a,{children:[[3,2,1].map((function(e){return Object(se.jsx)(te.a,{size:n||"xs",variant:"ghost","aria-label":"Death Save Failed",icon:c(e),cursor:i?"default":"auto",pointerEvents:i?"none":"auto",onClick:function(){return t.failedDeathSaves===e?r(Math.max(e-1,0),"fail"):r(Math.max(e,0),"fail")},hidden:i&&t.failedDeathSaves<e,minW:i?0:"24px"},"failed-save-".concat(e))})),Object(se.jsx)(p.a,{orientation:"vertical"}),[1,2,3].map((function(e){return Object(se.jsx)(te.a,{size:n||"xs",variant:"ghost","aria-label":"Death Save Suceeded",icon:s(e),cursor:i?"default":"auto",pointerEvents:i?"none":"auto",onClick:function(){return t.passedDeathSaves===e?r(Math.max(e-1,0),"pass"):r(Math.max(e,0),"pass")},minW:i?0:"24px",hidden:i&&t.passedDeathSaves<e},"passed-save-".concat(e))}))]})};function ht(e){var t=e.player,n=e.isActive,i=e.tinyMode,a=e.onClick,r=t.tempHP?" (".concat(t.tempHP,")"):"";return Object(se.jsxs)(b.a,{onClick:a,className:"turn-block turn-block-player",p:i?"0.1em":"0.5em",border:"".concat(n&&!i?"0.4em":"0.2em"," solid #00AA00").concat(n?"FF":22),borderRadius:"0.4em",opacity:n?"100%":"80%",cursor:"pointer",children:[t.conditions.map((function(e){return e.toLowerCase()})).includes("dying")&&Object(se.jsx)(bt,{player:t,size:i?"xs":"sm",disableAction:!0}),Object(se.jsxs)(Le.a,{templateColumns:"repeat(4, 1fr)",fontSize:i?"sm":"md",children:[Object(se.jsx)(he.a,{fontWeight:"bold",children:t.name}),Object(se.jsxs)(he.a,{children:[Object(se.jsx)(ne.a,{as:be.b})," ",t.armourClass]}),Object(se.jsxs)(he.a,{children:[Object(se.jsx)(ne.a,{as:fe.c})," ",t.currentHP," ",r," ","/"," ",t.maxHP]}),Object(se.jsxs)(he.a,{children:[Object(se.jsx)(ne.a,{as:be.e})," ",t.initiative+t.initiativeMod," ","(",t.initiative,Object(se.jsx)(ne.a,{as:be.c})," ",t.initiativeMod>=0?"+":"-"," ",Math.abs(t.initiativeMod),")"]})]}),t.conditions.length>0&&Object(se.jsx)(ue.a,{children:t.conditions.map((function(e){return Object(se.jsx)(st.a,{variant:"solid",children:e},e)}))})]})}var Ot=function(e){var t=e.players,n=e.npcs,i=e.showAllTurns,a=e.currentTurnId,r=t.map((function(e){return{character:e,type:"player"}})),c=n.map((function(e){return{character:e,type:"npc"}})),s=[].concat(Object(k.a)(r),Object(k.a)(c)).filter((function(e){return i||e.character.displayOnTurnOrder})).sort((function(e,t){var n=e.character,i=t.character;return i.initiative+i.initiativeMod-(n.initiative+n.initiativeMod)})),o=function(e){return e.map((function(e,t){return{isActive:0===t,character:e.character,type:e.type}}))};if(!a)return o(s);var l=s.findIndex((function(e){return e.character.id===a}))||0;return o([].concat(Object(k.a)(s.slice(l+1,s.length)),Object(k.a)(s.slice(0,l+1))))};function xt(){var e=Object(m.f)(),t=A().get("tinymode"),n=function(n){var i,a=n.type,r=n.id,c=t?null===(i=window.opener)||void 0===i?void 0:i.appHistory:e;if(c){c.push("/".concat(a,"/").concat(r));!function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!(t>=20)){var n=document.querySelector("#currentHP-".concat(r));n?n.focus():setTimeout((function(){e(t+1)}),50)}}()}},i=S((function(e){return e.players.players})),a=S((function(e){return e.npcs.npcs})),r=S((function(e){return e.campaign.currentTurnId})),c=P(),s=Ot({players:i,npcs:a,showAllTurns:!1,currentTurnId:r});return Object(se.jsxs)(b.a,{children:[Object(se.jsxs)(ue.c,{divider:t?void 0:Object(se.jsx)(ue.b,{color:"gray.200"}),mb:t?0:2,spacing:t?0:2,children:[s.map((function(e){var i=e.character,a=e.isActive,r=e.type;if("player"===r){var c=i;return Object(se.jsx)(ht,{onClick:function(){return n({type:"players",id:i.id})},isActive:a,player:c,tinyMode:t},i.id)}if("npc"===r){var s=i;return Object(se.jsx)(dt,{onClick:function(){return n({type:s.isHostile?"enemies":"npcs",id:i.id})},isActive:a,npc:s,tinyMode:t},i.id)}return!1})),";"]}),Object(se.jsxs)(ue.a,{position:"sticky",backgroundColor:"white",bottom:"0",width:"100%",children:[Object(se.jsxs)(Se.a,{onClick:function(){c(G()),c(y(""))},width:"100%",size:t?"sm":"md",variant:"outline",children:["Roll Initiative",Object(se.jsx)(ne.a,{as:be.c})]}),Object(se.jsx)(Se.a,{onClick:function(){if(!(s.length<1))if(r){var e=s.findIndex((function(e){return e.character.id===r}));if(e){var t=s[(e+1)%s.length];c(y(t.character.id))}else c(y(s[1].character.id))}else c(y(s[0].character.id))},width:"100%",size:t?"sm":"md",variant:"outline",children:"Next Turn"}),!t&&Object(se.jsx)(Se.a,{width:"100%",variant:"outline",size:t?"sm":"md",onClick:function(){return window.open("/dndtracker/?tinymode=true","dndtracker_turns","resizable,width=500,height=300")},children:"Display in Compact Mode"})]})]})}function pt(){var e=Object(m.f)(),t=Object(at.a)({defaultValue:[]}),n=t.value,i=t.setValue,r=Object(le.a)(),c=r.isOpen,s=r.onOpen,o=r.onClose,l=Object(a.useRef)(null),d=S((function(e){return e.players.players})),j=S((function(e){return e.npcs.npcs})),h=S((function(e){return e.campaign.currentTurnId})),f=Ot({players:d,npcs:j,showAllTurns:!1,currentTurnId:h}),v=f.filter((function(e){return"player"===e.type})).map((function(e){return e.character})),g=f.filter((function(e){return"npc"===e.type&&e.character.isHostile})).map((function(e){return e.character})),w=P(),C=Object(a.useState)(0),H=Object(u.a)(C,2),I=H[0],M=H[1],T=Object(a.useState)(0),A=Object(u.a)(T,2),N=[{title:"Modify Health",prop:"currentHP",value:I,setMethod:M},{title:"Modify THP",prop:"tempHP",value:A[0],setMethod:A[1]}],F=function(e,t,i){if(0!==e||i){var a=[],r=d.filter((function(e){return n.includes(e.id)})),c=i?function(e){return{id:e.id,tempHP:"tempHP"===t?0:Math.max(e.tempHP,0),currentHP:"currentHP"===t?e.maxHP:e.currentHP}}:function(n){return Object(it.a)({id:n.id},t,"tempHP"===t?Math.max(n[t]+e,0):Math.min(n[t]+e,n.maxHP))};r.forEach((function(e){a.push(K(c(e)))})),j.filter((function(e){return n.includes(e.id)})).forEach((function(e){a.push(D(c(e)))})),a.length&&a.map(w)}},E=[].concat(Object(k.a)(d),Object(k.a)(j)).reduce((function(e,t){return t.conditions.length&&t.conditions.forEach((function(t){e.includes(t)||e.push(t)})),e}),[]),R=Object(a.useState)(""),z=Object(u.a)(R,2),q=z[0],W=z[1],L=Object(a.useState)(""),_=Object(u.a)(L,2),V=_[0],J=_[1],U=function(e,t){if(e){var i=[],a=d.filter((function(e){return n.includes(e.id)})),r=function(n){var i=Object(k.a)(n),a=i.indexOf(e),r=a>-1;return"remove"===t&&r&&i.splice(a,1),"add"!==t||r||i.push(e),i};a.forEach((function(e){i.push(K({id:e.id,conditions:r(e.conditions)}))})),j.filter((function(e){return n.includes(e.id)})).forEach((function(e){i.push(D({id:e.id,conditions:r(e.conditions)}))})),i.length&&i.map(w)}};return Object(se.jsx)(ee.a,{children:Object(se.jsxs)(ue.c,{width:"100%",children:[Object(se.jsxs)(ue.a,{width:"100%",children:[Object(se.jsx)(Se.a,{flexGrow:1,disabled:0===n.length,size:"xs",onClick:function(){return i([])},children:"Deselect All Characters"}),Object(se.jsx)(Se.a,{flexGrow:1,onClick:function(){return i(v.map((function(e){return e.id})))},size:"xs",children:"Select All Players"}),Object(se.jsx)(Se.a,{flexGrow:1,onClick:function(){return i(g.map((function(e){return e.id})))},size:"xs",children:"Select All Enemies"})]}),Object(se.jsx)(ue.c,{width:"100%",spacing:1,children:Object(se.jsx)(rt.a,{defaultValue:[],value:n,onChange:i,children:f.map((function(t){var n=t.character,i=n,a=n,r=n.tempHP?" (".concat(n.tempHP,")"):"",c="";"player"===t.type?c="players":"npc"===t.type&&(c=i.isHostile?"enemies":"npcs");var s=Gt.neutral;return"players"===c?s=Gt.player:"enemies"===c?s=Gt.enemy:i.isFriendly&&(s=Gt.friendly),Object(se.jsxs)(b.a,{width:"100%",border:"0.1em solid ".concat(s),borderRadius:10,children:[n.conditions.map((function(e){return e.toLowerCase()})).includes("dying")&&"players"===c&&Object(se.jsx)(bt,{player:a,size:"xs"}),Object(se.jsxs)(Le.a,{alignItems:"center",templateColumns:"repeat(5, 1fr)",fontSize:"xs",pl:2,pr:2,gap:1,children:[Object(se.jsxs)(ue.a,{children:[Object(se.jsx)(ct.a,{value:n.id,size:"lg"})," ",Object(se.jsx)(he.a,{fontWeight:"bold",fontSize:"xs",children:n.name})]}),Object(se.jsxs)(b.a,{children:[Object(se.jsx)(ne.a,{as:be.b})," ",n.armourClass]}),Object(se.jsxs)(b.a,{children:[Object(se.jsx)(ne.a,{as:fe.c})," ",n.currentHP," ",r," ","/"," ",n.maxHP]}),Object(se.jsxs)(b.a,{children:[Object(se.jsx)(ne.a,{as:be.e})," ",n.initiative+n.initiativeMod," ","(",n.initiative,Object(se.jsx)(ne.a,{as:be.c})," ",n.initiativeMod>=0?"+":"-"," ",Math.abs(n.initiativeMod),")"]}),Object(se.jsx)(b.a,{children:Object(se.jsx)(te.a,{"aria-label":"Go to character",icon:Object(se.jsx)(ne.a,{as:me.d}),onClick:function(){return function(t){var n=t.type,i=t.id;e.push("/".concat(n,"/").concat(i)),function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!(t>=20)){var n=document.querySelector("#currentHP-".concat(i));n?n.focus():setTimeout((function(){e(t+1)}),50)}}()}({id:n.id,type:c})},size:"xs",m:1})})]},n.id),n.conditions.length>0&&Object(se.jsx)(ue.a,{pr:1,pl:1,pb:1,children:n.conditions.map((function(e){return Object(se.jsx)(st.a,{variant:"solid",children:e},e)}))})]},n.id)}))})}),Object(se.jsx)(ee.a,{height:c&&l.current?"".concat(l.current.clientHeight,"px"):0}),Object(se.jsxs)(ue.c,{width:"100%",position:"sticky",bottom:"0",backgroundColor:"white",p:2,children:[Object(se.jsx)(Se.a,{width:"100%",onClick:s,display:c?"none":"visible",children:"Show Edit Panel"}),Object(se.jsx)(ot.a,{direction:"bottom",in:c,ref:l,children:Object(se.jsx)(O.a,{children:Object(se.jsxs)(ue.c,{p:2,minW:"650",maxW:"800",backgroundColor:"white",children:[Object(se.jsx)(O.a,{children:Object(se.jsx)(x.a,{size:"md",children:"Edit Panel"})}),Object(se.jsx)(p.a,{}),Object(se.jsx)(Se.a,{width:"100%",onClick:o,size:"xs",children:"Hide This Panel"}),Object(se.jsx)(p.a,{}),Object(se.jsxs)(ue.a,{backgroundColor:"white",width:"100%",children:[Object(se.jsxs)(Se.a,{onClick:function(){w(G()),w(y(""))},width:"100%",children:["Roll Initiative",Object(se.jsx)(ne.a,{as:be.c})]}),Object(se.jsx)(Se.a,{onClick:function(){if(!(f.length<1))if(h){var e=f.findIndex((function(e){return e.character.id===h}));if(e){var t=f[(e+1)%f.length];w(y(t.character.id))}else w(y(f[1].character.id))}else w(y(f[0].character.id))},width:"100%",children:"Next Turn"})]}),Object(se.jsx)(p.a,{}),Object(se.jsx)(ue.a,{width:"100%",children:N.map((function(e){var t=e.title,i=e.prop,a=e.value,r=e.setMethod;return Object(se.jsxs)(ue.c,{width:"50%",children:[Object(se.jsx)(ee.a,{flexGrow:1,children:Object(se.jsx)(x.a,{size:"s",children:t})}),Object(se.jsx)(ue.a,{children:[-10,-5,-1,1,5,10].map((function(e){return Object(se.jsxs)(Se.a,{size:"xs",onClick:function(){return F(e,i)},variant:"outline",disabled:!n.length,children:[e>0&&"+",e]},e)}))}),Object(se.jsxs)(ue.a,{children:[Object(se.jsx)(Se.a,{variant:"outline",disabled:!n.length,onClick:function(){return F(-a,i)},children:"-"}),Object(se.jsx)(Ae.c,{value:a,onChange:function(e){return r(Number(e)||0)},width:"6em",disabled:!n.length,children:Object(se.jsx)(Ae.d,{})}),Object(se.jsx)(Se.a,{variant:"outline",disabled:!n.length,onClick:function(){return F(a,i)},children:"+"})]}),Object(se.jsx)(Se.a,{size:"xs",variant:"outline",disabled:!n.length,onClick:function(){return F(0,i,!0)},children:"Reset"})]},t)}))}),Object(se.jsx)(p.a,{}),Object(se.jsxs)(ue.c,{width:"100%",children:[Object(se.jsx)(x.a,{size:"s",children:"Modify Conditions"}),Object(se.jsxs)(ue.a,{width:"100%",children:[Object(se.jsxs)(ue.c,{width:"50%",children:[Object(se.jsx)(ie.a,{placeholder:"Name of condition",disabled:!n.length,value:V,onChange:function(e){return J(e.target.value)}}),Object(se.jsx)(Se.a,{width:"100%",disabled:!n.length,onClick:function(){return U(V,"add")},children:"Add Condition"})]}),Object(se.jsxs)(ue.c,{width:"50%",children:[Object(se.jsx)(lt.a,{placeholder:"Select condition to remove",disabled:!n.length||!E.length,value:q,onChange:function(e){return W(e.target.value)},children:E.map((function(e){return Object(se.jsx)("option",{value:e,children:e},e)}))}),Object(se.jsx)(Se.a,{width:"100%",disabled:!n.length||!E.length,onClick:function(){return U(q,"remove")},children:"Remove Condition"})]})]})]})]})})})]})]})})}var mt=n(209),ft=n.n(mt),vt=n(97),gt=n(4),yt=n(210),wt=n(211),Ct=n(212),Pt={"mod+b":"bold","mod+i":"italic","mod+u":"underline","mod+`":"code"},St=["numbered-list","bulleted-list"],kt=function(e,t){var n=gt.a.nodes(e,{match:function(e){return!gt.a.isEditor(e)&&gt.b.isElement(e)&&e.type===t}});return!!Object(u.a)(n,1)[0]},Ht=function(e,t){var n=gt.a.marks(e);return!!n&&!0===n[t]},It=function(e,t){Ht(e,t)?gt.a.removeMark(e,t):gt.a.addMark(e,t,!0)},Mt=function(e){var t=e.attributes,n=e.children;switch(e.element.type){case"block-quote":return Object(se.jsx)("blockquote",Object(H.a)(Object(H.a)({},t),{},{children:n}));case"bulleted-list":return Object(se.jsx)("ul",Object(H.a)(Object(H.a)({},t),{},{children:n}));case"heading-one":return Object(se.jsx)("h1",Object(H.a)(Object(H.a)({},t),{},{children:n}));case"heading-two":return Object(se.jsx)("h2",Object(H.a)(Object(H.a)({},t),{},{children:n}));case"list-item":return Object(se.jsx)("li",Object(H.a)(Object(H.a)({},t),{},{children:n}));case"numbered-list":return Object(se.jsx)("ol",Object(H.a)(Object(H.a)({},t),{},{children:n}));default:return Object(se.jsx)("p",Object(H.a)(Object(H.a)({},t),{},{children:n}))}},Tt=function(e){var t=e.attributes,n=e.children,i=e.leaf,a=n;return i.bold&&(a=Object(se.jsx)("strong",Object(H.a)(Object(H.a)({},t),{},{children:n}))),i.code&&(a=Object(se.jsx)("code",Object(H.a)(Object(H.a)({},t),{},{children:n}))),i.italic&&(a=Object(se.jsx)("em",Object(H.a)(Object(H.a)({},t),{},{children:n}))),i.underline&&(a=Object(se.jsx)("u",Object(H.a)(Object(H.a)({},t),{},{children:n}))),Object(se.jsx)("span",Object(H.a)(Object(H.a)({},t),{},{children:a}))},At=function(e){var t=e.format,n=e.icon,i=Object(vt.c)(),a=kt(i,t);return Object(se.jsx)(te.a,{"aria-label":t,icon:Object(se.jsx)(ne.a,{as:n,color:a?void 0:"gray.300"}),variant:"outline",onClick:function(e){e.preventDefault(),function(e,t){var n=kt(e,t),i=St.includes(t);gt.h.unwrapNodes(e,{match:function(e){return St.includes(String(!gt.a.isEditor(e)&&gt.b.isElement(e)&&e.type))},split:!0});var a={type:n?"paragraph":i?"list-item":t};if(gt.h.setNodes(e,a),!n&&i){var r={type:t,children:[]};gt.h.wrapNodes(e,r)}}(i,t)}})},Nt=function(e){var t=e.format,n=e.icon,i=Object(vt.c)(),a=Ht(i,t);return Object(se.jsx)(te.a,{"aria-label":t,icon:Object(se.jsx)(ne.a,{as:n,color:a?void 0:"gray.300"}),variant:"outline",onClick:function(e){e.preventDefault(),It(i,t)}})},Ft=[{type:"paragraph",children:[{text:"This is editable "},{text:"rich",bold:!0},{text:" text, "},{text:"much",italic:!0},{text:" better than a "},{text:"<textarea>",code:!0},{text:"!"}]},{type:"paragraph",children:[{text:"Since it's rich text, you can do things like turn a selection of text "},{text:"bold",bold:!0},{text:", or add a semantically rendered block quote in the middle of the page, like this:"}]},{type:"block-quote",children:[{text:"A wise quote."}]},{type:"paragraph",children:[{text:"Try it out for yourself!"}]}],Et=function(){var e=Object(a.useState)(Ft),t=Object(u.a)(e,2),n=t[0],i=t[1],r=Object(a.useCallback)((function(e){return Object(se.jsx)(Mt,Object(H.a)({},e))}),[]),c=Object(a.useCallback)((function(e){return Object(se.jsx)(Tt,Object(H.a)({},e))}),[]),s=Object(a.useMemo)((function(){return Object(yt.a)(Object(vt.d)(Object(gt.i)()))}),[]);return Object(se.jsxs)(vt.b,{editor:s,value:n,onChange:function(e){return i(e)},children:[Object(se.jsxs)(ue.a,{children:[Object(se.jsx)(Nt,{format:"bold",icon:ae.a}),Object(se.jsx)(Nt,{format:"italic",icon:ae.c}),Object(se.jsx)(Nt,{format:"underline",icon:wt.a}),Object(se.jsx)(Nt,{format:"code",icon:ae.b}),Object(se.jsx)(At,{format:"heading-one",icon:ve.c}),Object(se.jsx)(At,{format:"heading-two",icon:Ct.a}),Object(se.jsx)(At,{format:"block-quote",icon:ae.g}),Object(se.jsx)(At,{format:"numbered-list",icon:ae.d}),Object(se.jsx)(At,{format:"bulleted-list",icon:ae.e})]}),Object(se.jsx)(p.a,{mt:3,mb:3}),Object(se.jsx)(vt.a,{renderElement:r,renderLeaf:c,placeholder:"Enter some rich text\u2026",spellCheck:!0,autoFocus:!0,onKeyDown:function(e){Object.entries(Pt).forEach((function(t){var n=Object(u.a)(t,2),i=n[0],a=n[1];ft()(i,e)&&(e.preventDefault(),It(s,a))}))}})]})},Rt=(n(341),function(){return Object(se.jsxs)(b.a,{p:5,border:"1px solid #DDDDDD",borderRadius:8,children:[!1,Object(se.jsx)(Et,{})]})}),zt=n(24),qt=n.n(zt),Dt=n(162),Wt=n(383),Lt=function(e){var t=e.confirmAction,n=Object(le.a)(),i=n.isOpen,r=n.onOpen,c=n.onClose,s=Object(a.useRef)(null);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Se.a,{width:"100%",colorScheme:"red",onClick:r,children:"Clear State"}),Object(se.jsx)(Wt.a,{isOpen:i,leastDestructiveRef:s,onClose:c,children:Object(se.jsx)(je.h,{children:Object(se.jsxs)(Wt.b,{children:[Object(se.jsx)(je.g,{fontSize:"lg",fontWeight:"bold",children:"Clear State"}),Object(se.jsx)(je.b,{children:"Are you sure? This action cannot be undone."}),Object(se.jsxs)(je.f,{children:[Object(se.jsx)(Se.a,{ref:s,onClick:c,children:"Cancel"}),Object(se.jsx)(Se.a,{colorScheme:"red",onClick:function(){c(),t()},ml:3,children:"Delete"})]})]})})})]})},_t=function(){var e=S((function(e){return e})),t=Object(a.useState)(""),n=Object(u.a)(t,2),i=n[0],r=n[1],c=Object(a.useRef)(null),s=Object(a.useRef)(null),o=function(e){try{var t=JSON.parse(e);localStorage.setItem("".concat(X,"_").concat(Y),JSON.stringify(t.state)),window.location.reload()}catch(n){console.error("Failed to import state")}};return Object(a.useEffect)((function(){!function(){var t=new Blob([JSON.stringify({version:Y,state:e,date:Date.now()})],{type:"application/json"});""!==i&&window.URL.revokeObjectURL(i),r(window.URL.createObjectURL(t))}()}),[e]),Object(se.jsxs)(Le.a,{templateColumns:"repeat(1, 1fr)",gap:5,children:[Object(se.jsxs)(ee.a,{children:[Object(se.jsx)("input",{type:"file",accept:"application/json",onChange:function(){var e=Object(Dt.a)(qt.a.mark((function e(t){var n,i,a;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),(a=new FileReader).onload=function(){var e=Object(Dt.a)(qt.a.mark((function e(t){var n,i;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"string"===typeof(i=null===t||void 0===t||null===(n=t.target)||void 0===n?void 0:n.result)&&o(i);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.readAsText(null===(n=s.current)||void 0===n||null===(i=n.files)||void 0===i?void 0:i[0]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ref:s,hidden:!0}),Object(se.jsx)(Se.a,{width:"100%",onClick:function(){var e;null===(e=s.current)||void 0===e||e.click()},children:"Import Saved State"})]}),Object(se.jsxs)(ee.a,{children:[Object(se.jsx)("a",{hidden:!0,download:"".concat(Date.now(),"_").concat(Y,"_").concat(e.campaign.campaignTitle,".json"),href:i,ref:c,children:"Export"}),Object(se.jsx)(Se.a,{width:"100%",onClick:function(){var e;return null===(e=c.current)||void 0===e?void 0:e.click()},children:"Export Save State"})]}),Object(se.jsx)(Lt,{confirmAction:function(){localStorage.removeItem("".concat(X,"_").concat(Y)),window.location.reload()}})]})},Vt=[{component:Object(se.jsx)(xt,{}),path:"/",basePath:"/",exact:!0,pageTitle:"Turn Order",icon:ve.a},{component:Object(se.jsx)(pt,{}),path:"/screen",basePath:"/screen",pageTitle:"Multi Edit",icon:ve.e},{component:Object(se.jsx)(nt,{}),path:"/players",basePath:"/players/:id?",pageTitle:"Players",icon:fe.d},{component:Object(se.jsx)($e,{showHostile:!0}),path:"/enemies",basePath:"/enemies/:id?",pageTitle:"Enemies",icon:be.a},{component:Object(se.jsx)($e,{showFriendly:!0,showNeutral:!0}),path:"/npcs",basePath:"/npcs/:id?",pageTitle:"Other NPCs",icon:me.b},{component:Object(se.jsx)(Rt,{}),path:"/notes",basePath:"/notes",pageTitle:"Campaign Notes",icon:me.c,disabled:!0},{component:Object(se.jsx)(_t,{}),path:"/settings",basePath:"/settings",pageTitle:"Settings",icon:ve.b}];function Jt(){var e=P(),t=Object(m.f)(),n=A();window.appHistory=t;var i=n.get("tinymode"),a=i?[400,800]:[650,800],r=Object(u.a)(a,2),c=r[0],s=r[1];return window.addEventListener("storage",(function(){var t,n,i,a,r=Z();document.hasFocus()||[B((null===r||void 0===r||null===(t=r.players)||void 0===t?void 0:t.players)||[]),q((null===r||void 0===r||null===(n=r.npcs)||void 0===n?void 0:n.npcs)||[]),w((null===r||void 0===r||null===(i=r.campaign)||void 0===i?void 0:i.campaignTitle)||""),y((null===r||void 0===r||null===(a=r.campaign)||void 0===a?void 0:a.currentTurnId)||"")].map(e)})),Object(se.jsxs)(b.a,{className:"App",pt:i?"0":"2em",children:[!i&&Object(se.jsx)(pe,{routes:Vt}),Object(se.jsxs)(h.a,{maxW:s,minW:c,children:[!i&&Object(se.jsx)(oe,{}),Object(se.jsx)(m.c,{children:Vt.map((function(e){var t=e.component,n=e.basePath,a=e.pageTitle,r=e.exact;return Object(se.jsxs)(m.a,{path:n,exact:r,children:[!i&&Object(se.jsxs)(b.a,{children:[Object(se.jsx)(O.a,{children:Object(se.jsx)(x.a,{size:"md",children:a})}),Object(se.jsx)(p.a,{mt:4,mb:4})]}),t]},a)}))})]})]})}var Ut=n(385),Bt=Object(Ut.a)({components:{Drawer:{variants:{alwaysOpen:{dialog:{pointerEvents:"auto"},dialogContainer:{pointerEvents:"none"}}}}}}),Gt={enemy:"#AA0000",friendly:"#AAAA00",neutral:"#AAAAAA",player:"#00AA00"};s.a.render(Object(se.jsx)(l.a,{store:$,children:Object(se.jsx)(o.a,{theme:Bt,children:Object(se.jsx)(r.a.StrictMode,{children:Object(se.jsx)(d.a,{basename:"/dndtracker",children:Object(se.jsx)(Jt,{})})})})}),document.getElementById("root")),j()}},[[342,1,2]]]);
//# sourceMappingURL=main.6b3ddd27.chunk.js.map